[["index.html", "Pathway analysis methods Prefeace", " Pathway analysis methods Siying Huang Updated: 2024-01-22 Prefeace knitr::opts_chunk$set(echo = T, comment = &#39;&#39;,message = F, warning = F, error=F) options(width = 100) "],["gene-sets-and-pathways.html", "1 Gene sets and pathways 1.1 Organization of this e-book", " 1 Gene sets and pathways Definition 1.1 (definition name) gene set , biological pathway 1.1 Organization of this e-book I will illustrate the gene pathway analysis using a public dataset for smoking study. Chapter 2 contains information on this study and how to obtain the dataset from NCBI website to an R environment. Chapter 3 quickly illustrate the differential gene expression analysis. This result will be used in some of the parametrical pathway analysis method. Chapter 4 introduce over-representation analysis Chapter 5 introduce the classic gene set enrichment analysis Chapter 6 talks abou the gene set variation analysis Chapter 7 discusses other methods for gene set enrichment analysis Chapter 8 talks about advanced topic regarding gene set analysis "],["hello-bookdown.html", "2 Hello bookdown 2.1 A section", " 2 Hello bookdown All chapters start with a first-level heading followed by your chapter title, like the line above. There should be only one first-level heading (#) per .Rmd file. 2.1 A section All chapter sections start with a second-level (##) or higher heading followed by your section title, like the sections above and below here. You can have as many as you want within a chapter. An unnumbered section Chapters and sections are numbered by default. To un-number a heading, add a {.unnumbered} or the shorter {-} at the end of the heading, like in this section. "],["study-dataset.html", "3 Study dataset 3.1 Extracting data from NCBI Gene Expression Omnibus databse 3.2 convert to GDS to expression set", " 3 Study dataset In this tutorial, I still use the pulic smoking study dataset from NCBI Gene Expression Omnibus (GEO) database - GDS3713 (GSE18723). 3.1 Extracting data from NCBI Gene Expression Omnibus databse Using GEOquery library to retrieve data from NCBI database. The GDS dataset is stored in the gds R4 class object. library(here) library(GEOquery) library(dplyr) gds &lt;- getGEO(&quot;GDS3713&quot;) # gds@header # meta data of the experiment # gds@dataTable@table # expression data # gds@dataTable@columns # phenotype data structure of the gds object str(gds, max.level = 3) Formal class &#39;GDS&#39; [package &quot;GEOquery&quot;] with 3 slots ..@ gpl :Formal class &#39;GPL&#39; [package &quot;GEOquery&quot;] with 2 slots ..@ dataTable:Formal class &#39;GEODataTable&#39; [package &quot;GEOquery&quot;] with 2 slots ..@ header :List of 23 .. ..$ channel_count : chr &quot;1&quot; .. ..$ dataset_id : chr [1:2] &quot;GDS3713&quot; &quot;GDS3713&quot; .. ..$ description : chr [1:3] &quot;Analysis of peripheral circulating B cells from smoking and non-smoking healthy US white females. B cells are d&quot;| __truncated__ &quot;control&quot; &quot;cigarette smoke&quot; .. ..$ email : chr &quot;geo@ncbi.nlm.nih.gov&quot; .. ..$ feature_count : chr &quot;22283&quot; .. ..$ institute : chr &quot;NCBI NLM NIH&quot; .. ..$ name : chr &quot;Gene Expression Omnibus (GEO)&quot; .. ..$ order : chr &quot;none&quot; .. ..$ platform : chr &quot;GPL96&quot; .. ..$ platform_organism : chr &quot;Homo sapiens&quot; .. ..$ platform_technology_type: chr &quot;in situ oligonucleotide&quot; .. ..$ pubmed_id : chr &quot;20217071&quot; .. ..$ ref : chr &quot;Nucleic Acids Res. 2005 Jan 1;33 Database Issue:D562-6&quot; .. ..$ reference_series : chr &quot;GSE18723&quot; .. ..$ sample_count : chr &quot;79&quot; .. ..$ sample_id : chr [1:2] &quot;GSM464697,GSM464698,GSM464699,GSM464700,GSM464701,GSM464702,GSM464703,GSM464704,GSM464705,GSM464706,GSM464707,G&quot;| __truncated__ &quot;GSM464658,GSM464659,GSM464660,GSM464661,GSM464662,GSM464663,GSM464664,GSM464665,GSM464666,GSM464667,GSM464668,G&quot;| __truncated__ .. ..$ sample_organism : chr &quot;Homo sapiens&quot; .. ..$ sample_type : chr &quot;RNA&quot; .. ..$ title : chr &quot;Smoking effect on B lymphocytes in females&quot; .. ..$ type : chr [1:3] &quot;Expression profiling by array&quot; &quot;stress&quot; &quot;stress&quot; .. ..$ update_date : chr &quot;Jul 11 2010&quot; .. ..$ value_type : chr &quot;count&quot; .. ..$ web_link : chr &quot;http://www.ncbi.nlm.nih.gov/geo&quot; 3.1.1 Summary of the study This study aim to analyze peripheral circulating B cells from smoking and non-smoking healthy US white females. B cells are directly associated with the onset and development of many smoking-induced diseases. Results provide insight into the molecular basis of B cell involvement in smoking-related pathogenesis. It contains 39 smoker and 40 non-smokers. 3.1.2 Assigning the expression and phenotype data The expression data is stored in the gds@dataTable@tabl with gene in The rows and subjects in the columns. The phenotype data is store at gds@dataTable@columns. expr &lt;- Table(gds) summary(expr[, 1:4]) ID_REF IDENTIFIER GSM464697 GSM464698 Length:22283 Length:22283 Min. : 1.53 Min. : 1.06 Class :character Class :character 1st Qu.: 65.44 1st Qu.: 74.40 Mode :character Mode :character Median : 221.78 Median : 243.15 Mean : 859.82 Mean : 752.89 3rd Qu.: 582.95 3rd Qu.: 600.85 Max. :51356.90 Max. :34387.10 pheno &lt;- Columns(gds) summary(pheno) sample stress description Length:79 cigarette smoke:39 Length:79 Class :character control :40 Class :character Mode :character Mode :character 3.2 convert to GDS to expression set Converting the gds object to expression set will generate a series of sub documents, including an annotation file of the genes in the expression data. eset &lt;- GDS2eSet(gds) dim(pData(eset)) # pheno data, data.frame [1] 79 3 str(eset, max.level =4) Formal class &#39;ExpressionSet&#39; [package &quot;Biobase&quot;] with 7 slots ..@ experimentData :Formal class &#39;MIAME&#39; [package &quot;Biobase&quot;] with 13 slots .. .. ..@ name : chr &quot;&quot; .. .. ..@ lab : chr &quot;&quot; .. .. ..@ contact : chr &quot;&quot; .. .. ..@ title : chr &quot;Smoking effect on B lymphocytes in females&quot; .. .. ..@ abstract : chr &quot;Analysis of peripheral circulating B cells from smoking and non-smoking healthy US white females. B cells are d&quot;| __truncated__ .. .. ..@ url : chr &quot;&quot; .. .. ..@ pubMedIds : chr &quot;20217071&quot; .. .. ..@ samples : list() .. .. ..@ hybridizations : list() .. .. ..@ normControls : list() .. .. ..@ preprocessing : list() .. .. ..@ other :List of 23 .. .. ..@ .__classVersion__:Formal class &#39;Versions&#39; [package &quot;Biobase&quot;] with 1 slot ..@ assayData :&lt;environment: 0x1179ef70&gt; ..@ phenoData :Formal class &#39;AnnotatedDataFrame&#39; [package &quot;Biobase&quot;] with 4 slots .. .. ..@ varMetadata :&#39;data.frame&#39;: 3 obs. of 1 variable: .. .. ..@ data :&#39;data.frame&#39;: 79 obs. of 3 variables: .. .. ..@ dimLabels : chr [1:2] &quot;sampleNames&quot; &quot;sampleColumns&quot; .. .. ..@ .__classVersion__:Formal class &#39;Versions&#39; [package &quot;Biobase&quot;] with 1 slot ..@ featureData :Formal class &#39;AnnotatedDataFrame&#39; [package &quot;Biobase&quot;] with 4 slots .. .. ..@ varMetadata :&#39;data.frame&#39;: 21 obs. of 2 variables: .. .. ..@ data :&#39;data.frame&#39;: 22283 obs. of 21 variables: .. .. ..@ dimLabels : chr [1:2] &quot;featureNames&quot; &quot;featureColumns&quot; .. .. ..@ .__classVersion__:Formal class &#39;Versions&#39; [package &quot;Biobase&quot;] with 1 slot ..@ annotation : chr(0) ..@ protocolData :Formal class &#39;AnnotatedDataFrame&#39; [package &quot;Biobase&quot;] with 4 slots .. .. ..@ varMetadata :&#39;data.frame&#39;: 0 obs. of 1 variable: .. .. ..@ data :&#39;data.frame&#39;: 79 obs. of 0 variables .. .. ..@ dimLabels : chr [1:2] &quot;sampleNames&quot; &quot;sampleColumns&quot; .. .. ..@ .__classVersion__:Formal class &#39;Versions&#39; [package &quot;Biobase&quot;] with 1 slot ..@ .__classVersion__:Formal class &#39;Versions&#39; [package &quot;Biobase&quot;] with 1 slot .. .. ..@ .Data:List of 4 .. .. ..$ names: chr [1:4] &quot;R&quot; &quot;Biobase&quot; &quot;eSet&quot; &quot;ExpressionSet&quot; # gene annotations annot_cols &lt;- eset@featureData@varMetadata annot_data &lt;- eset@featureData@data "],["cross.html", "4 Cross-references 4.1 Chapters and sub-chapters 4.2 Captioned figures and tables", " 4 Cross-references Cross-references make it easier for your readers to find and link to elements in your book. 4.1 Chapters and sub-chapters There are two steps to cross-reference any heading: Label the heading: # Hello world {#nice-label}. Leave the label off if you like the automated heading generated based on your heading title: for example, # Hello world = # Hello world {#hello-world}. To label an un-numbered heading, use: # Hello world {-#nice-label} or {# Hello world .unnumbered}. Next, reference the labeled heading anywhere in the text using \\@ref(nice-label); for example, please see Chapter 4. If you prefer text as the link instead of a numbered reference use: any text you want can go here. 4.2 Captioned figures and tables Figures and tables with captions can also be cross-referenced from elsewhere in your book using \\@ref(fig:chunk-label) and \\@ref(tab:chunk-label), respectively. See Figure 4.1. par(mar = c(4, 4, .1, .1)) plot(pressure, type = &#39;b&#39;, pch = 19) Figure 4.1: Here is a nice figure! Donâ€™t miss Table 4.1. knitr::kable( head(pressure, 10), caption = &#39;Here is a nice table!&#39;, booktabs = TRUE ) Table 4.1: Here is a nice table! temperature pressure 0 0.0002 20 0.0012 40 0.0060 60 0.0300 80 0.0900 100 0.2700 120 0.7500 140 1.8500 160 4.2000 180 8.8000 "],["query-bioloical-pathway-databases.html", "5 Query bioloical pathway databases 5.1 Gene annotation 5.2 Convert gene symbol to gene ID using biomaRt. 5.3 Curate biological functions 5.4 Reference", " 5 Query bioloical pathway databases For this practice, weâ€™ll use the result from differential gene expression analysis. 5.1 Gene annotation The GDS3713 dataset comes with an annotation file that has information for genes in the array: cat(paste0(names(annot), collapse = &#39;\\t&#39;)) ID Gene.title Gene.symbol Gene.ID UniGene.title UniGene.symbol UniGene.ID Nucleotide.Title GI GenBank.Accession Platform_CLONEID Platform_ORF Platform_SPOTID Chromosome.location Chromosome.annotation GO.Function GO.Process GO.Component GO.Function.ID GO.Process.ID GO.Component.ID One can directly query a specific gene from this file. For example, we can look up the ICOSLG information. datatable(annot[which(annot$Gene.symbol == &quot;ICOSLG&quot;), ], rownames = F ) However, most of time, we donâ€™t have such a file that comes with the trancriptomic data. We will then need to annotate the genes. 5.2 Convert gene symbol to gene ID using biomaRt. Since many pathway database requires entrez gene IDs as entries and most of sequencing/ microarray output provides gene symbols or ensembl IDs, weâ€™ll need to convert gene symbol to entrez IDs for the pathway analysis. We can query from the ensembl site manually. Or we can do better usingbiomaRtpackage. For a full tutorial of biomaRt package, see here. It covers some more advanced use case. Here I only cover basic usage of this package. 5.2.1 Connect to the selected BioMart database using useEnsembl function. Before connecting to a specific database, we can first check available databases. 5.2.1.1 List of available BioMart databases hosted by Ensembl # available database datatable(listEnsembl()) # available biological species for the gene databases mart &lt;- useEnsembl(&quot;genes&quot;, mirror = &#39;www&#39;) datatable(listDatasets(mart)) Since we want to convert gene symbol to Entrez gene IDs in human subjects, we select biomart = 'genes' and dataset= 'hsapiens_gene_ensembl'. Use useEnsembl function to setup the connection with ensembl site host. # convert from gene symbol to gene ID ensembl &lt;- useEnsembl( biomart = &quot;genes&quot;, dataset = &quot;hsapiens_gene_ensembl&quot;, mirror = &quot;www&quot; ) 5.2.2 Annotate genes Here instead of selecting genes in a biological pathway, I simply randomly choose some genes in the dataset. set.seed(123) gs1 &lt;- sample(rst$ID, 10) gs2 &lt;- sample(rst$ID, 10) Here I choose five most significantly differentially expressed genes, five genes not differentially expressed. gs3 &lt;- c(head(rst$ID, 5), tail(rst$ID, 5)) print(glue::glue(&#39;geneset 1: {paste0(gs1, collapse = &quot;, &quot;)} geneset 2: {paste0(gs2, collapse =&quot;, &quot;)}\\ngeneset 3: {paste0(gs3, collapse =&quot;, &quot;)}&#39;)) geneset 1: HAUS5, MYDGF, TRAPPC13, LINS1, SLC14A1, DYRK3, EIF3I, NRP2, 207479_at, SESN1 geneset 2: ALDH6A1, MAPKAPK5-AS1, WNT7A, GH1, SMYD2, NT5DC2, CCDC30, MTSS1L, CETP, DZIP3 geneset 3: EBP, H3F3AP4, RAB2A, LOC100506248, MFSD11, NAP1L3, C19orf54, ADGRG6, PHF1, BCL2L14 Retreive the annotated file with getBM function. Since we use gene symbols to match aginst gene IDs, weâ€™ll need to specify the type of input data in the filter argument (filters = \"hgnc_symbol\"). We would like to output the hgnc_symbol,entrezgene_id reference. annotgs3 &lt;- getBM( attributes = c(&quot;hgnc_symbol&quot;, &quot;entrezgene_id&quot;), filters = &quot;hgnc_symbol&quot;, values = gs3, mart = ensembl ) print(annotgs3) hgnc_symbol entrezgene_id 1 ADGRG6 57211 2 BCL2L14 79370 3 EBP 10682 4 MFSD11 79157 5 NAP1L3 4675 6 PHF1 5252 7 RAB2A 5862 Note that not all gene symbols can be perfectly match against gene ID. Alternatively, you can annotate all the gene in the dataset then extract the ones in the genesets. For simplicity, I removed duplicated genes of which have multiple probes correspond to the same gene (isoforms). In practice, the removal of these isoforms should be done with examination of coefficient variation (CV). all_genes &lt;- rst$ID[!duplicated(rst$ID)] Upon removal of duplicates, there are 14063 genes left in the dataset. We annotate these genes. annot_all &lt;- getBM( attributes = c(&quot;hgnc_symbol&quot;, &quot;entrezgene_id&quot;), filters = &quot;hgnc_symbol&quot;, values = all_genes, mart = ensembl ) 5.2.3 Alternative methods for annotation Alternatively one can use bitr function from clusterProfiler package. Here we need to specify the database for curation. This requires the pacakge org.Hs.eg.db. If you decide to go with method, make sure to update this package often to obtain the most current information. The org.Hs.eg.db package is updated biannually. bitr(gs1, fromType = &quot;SYMBOL&quot;, toType = c(&quot;ENTREZID&quot;, &quot;SYMBOL&quot;), OrgDb = org.Hs.eg.db ) SYMBOL ENTREZID 1 HAUS5 23354 2 MYDGF 56005 3 TRAPPC13 80006 4 LINS1 55180 5 SLC14A1 6563 6 DYRK3 8444 7 EIF3I 8668 8 NRP2 8828 10 SESN1 27244 5.3 Curate biological functions Upon selection genes of interest, we can start to curate the biological functions of these genes. The most popular databases are GO, KEGG, Reactome, etc. For full understanding the property of each of these databases, see these references [xxx]. For example, Iâ€™d like to query the biological functions of genes in the set 3 . One can use the groupGO function to look up biological functions: MF: Molecular Function molecular activities of gene products CC: Cellular Component where gene products are active BP: Biological Process pathways and larger processes made up of the activities of multiple gene products Additionally, one can look up onto KEGG, WikiPathway, Reactome, Diease Ontology (DO), Medical Subject Headings (MeSH), Molecular Signatures Database (MSigDb). I didnâ€™t find any ready to use functions from clusterProfile package,except for GO query. However, personally, I donâ€™t think statiticians are the experts to interpret the finding in biological sense. Since this is less of interest for analysts, the clusterProfiler simplifed this curation process and combined with the tests (ORA, GSEA) in their function construction. ggo &lt;- groupGO( gene = as.character(annotgs3$entrezgene_id), OrgDb = org.Hs.eg.db, ont = &quot;BP&quot;, level = 3, readable = TRUE ) tail(ggo) ID GO:0051410 GO:0051410 GO:0061687 GO:0061687 GO:0071722 GO:0071722 GO:0140330 GO:0140330 GO:1990961 GO:1990961 GO:0031214 GO:0031214 Description Count GO:0051410 detoxification of nitrogen compound 0 GO:0061687 detoxification of inorganic compound 0 GO:0071722 detoxification of arsenic-containing substance 0 GO:0140330 xenobiotic detoxification by transmembrane export across the cell outer membrane 0 GO:1990961 xenobiotic detoxification by transmembrane export across the plasma membrane 0 GO:0031214 biomineral tissue development 0 GeneRatio geneID GO:0051410 0/7 GO:0061687 0/7 GO:0071722 0/7 GO:0140330 0/7 GO:1990961 0/7 GO:0031214 0/7 5.4 Reference "],["parts.html", "6 Parts", " 6 Parts You can add parts to organize one or more book chapters together. Parts can be inserted at the top of an .Rmd file, before the first-level chapter heading in that same file. Add a numbered part: # (PART) Act one {-} (followed by # A chapter) Add an unnumbered part: # (PART\\*) Act one {-} (followed by # A chapter) Add an appendix as a special kind of un-numbered part: # (APPENDIX) Other stuff {-} (followed by # A chapter). Chapters in an appendix are prepended with letters instead of numbers. "],["footnotes-and-citations.html", "7 Footnotes and citations 7.1 Footnotes 7.2 Citations", " 7 Footnotes and citations 7.1 Footnotes Footnotes are put inside the square brackets after a caret ^[]. Like this one.1 7.2 Citations Reference items in your bibliography file(s) using @key. For example, we are using the bookdown package (R-bookdown?) (check out the last code chunk in index.Rmd to see how this citation key was added) in this sample book, which was built on top of R Markdown and knitr (xie2015?) (this citation was added manually in an external file book.bib). Note that the .bib files need to be listed in the index.Rmd with the YAML bibliography key. The RStudio Visual Markdown Editor can also make it easier to insert citations: https://rstudio.github.io/visual-markdown-editing/#/citations This is a footnote.â†©ï¸Ž "],["blocks.html", "8 Blocks 8.1 Equations 8.2 Theorems and proofs 8.3 Callout blocks", " 8 Blocks 8.1 Equations Here is an equation. \\[\\begin{equation} f\\left(k\\right) = \\binom{n}{k} p^k\\left(1-p\\right)^{n-k} \\tag{8.1} \\end{equation}\\] You may refer to using \\@ref(eq:binom), like see Equation (8.1). 8.2 Theorems and proofs Labeled theorems can be referenced in text using \\@ref(thm:tri), for example, check out this smart theorem 8.1. Theorem 8.1 For a right triangle, if \\(c\\) denotes the length of the hypotenuse and \\(a\\) and \\(b\\) denote the lengths of the other two sides, we have \\[a^2 + b^2 = c^2\\] Read more here https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html. 8.3 Callout blocks The R Markdown Cookbook provides more help on how to use custom blocks to design your own callouts: https://bookdown.org/yihui/rmarkdown-cookbook/custom-blocks.html "],["sharing-your-book.html", "9 Sharing your book 9.1 Publishing 9.2 404 pages 9.3 Metadata for sharing", " 9 Sharing your book 9.1 Publishing HTML books can be published online, see: https://bookdown.org/yihui/bookdown/publishing.html 9.2 404 pages By default, users will be directed to a 404 page if they try to access a webpage that cannot be found. If youâ€™d like to customize your 404 page instead of using the default, you may add either a _404.Rmd or _404.md file to your project root and use code and/or Markdown syntax. 9.3 Metadata for sharing Bookdown HTML books will provide HTML metadata for social sharing on platforms like Twitter, Facebook, and LinkedIn, using information you provide in the index.Rmd YAML. To setup, set the url for your book and the path to your cover-image file. Your bookâ€™s title and description are also used. This gitbook uses the same social sharing data across all chapters in your book- all links shared will look the same. Specify your bookâ€™s source repository on GitHub using the edit key under the configuration options in the _output.yml file, which allows users to suggest an edit by linking to a chapterâ€™s source file. Read more about the features of this output format here: https://pkgs.rstudio.com/bookdown/reference/gitbook.html Or use: ?bookdown::gitbook "],["references.html", "References", " References "],["appendix.html", "Appendix 9.4 Biological process data bases 9.5 Summary of currently available pathway analysis methods", " Appendix 9.4 Biological process data bases 9.5 Summary of currently available pathway analysis methods 9.5.1 Over-representation analysis 9.5.2 Gene set enrichment analysis "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
