[["index.html", "1 Preface", " 1 Preface hello "],["intro.html", "2 Intro", " 2 Intro Session Info sessionInfo() ## R version 4.1.0 (2021-05-18) ## Platform: x86_64-pc-linux-gnu (64-bit) ## Running under: Ubuntu 20.04.2 LTS ## ## Matrix products: default ## BLAS: /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 ## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0 ## ## locale: ## [1] LC_CTYPE=C.UTF-8 LC_NUMERIC=C LC_TIME=C.UTF-8 LC_COLLATE=C.UTF-8 ## [5] LC_MONETARY=C.UTF-8 LC_MESSAGES=C.UTF-8 LC_PAPER=C.UTF-8 LC_NAME=C ## [9] LC_ADDRESS=C LC_TELEPHONE=C LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C ## ## attached base packages: ## [1] parallel stats4 stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] GEOquery_2.60.0 dplyr_1.0.10 limma_3.48.2 DT_0.26 ## [5] biomaRt_2.48.2 org.Hs.eg.db_3.13.0 AnnotationDbi_1.54.1 IRanges_2.26.0 ## [9] S4Vectors_0.30.0 Biobase_2.52.0 BiocGenerics_0.38.0 DOSE_3.18.3 ## [13] enrichplot_1.12.3 clusterProfiler_4.0.5 here_1.0.1 ## ## loaded via a namespace (and not attached): ## [1] shadowtext_0.1.1 fastmatch_1.1-3 servr_0.22 BiocFileCache_2.0.0 ## [5] plyr_1.8.6 igraph_1.2.6 lazyeval_0.2.2 splines_4.1.0 ## [9] BiocParallel_1.26.1 crosstalk_1.1.1 GenomeInfoDb_1.28.1 ggplot2_3.4.0 ## [13] digest_0.6.27 yulab.utils_0.0.4 htmltools_0.5.5 GOSemSim_2.18.1 ## [17] viridis_0.6.1 GO.db_3.13.0 fansi_0.5.0 magrittr_2.0.3 ## [21] memoise_2.0.1 scriptResume_0.1.4 tzdb_0.1.2 readr_2.0.0 ## [25] Biostrings_2.60.1 graphlayouts_0.8.0 vroom_1.5.3 prettyunits_1.1.1 ## [29] colorspace_2.0-2 blob_1.2.2 rappdirs_0.3.3 ggrepel_0.9.1 ## [33] xfun_0.39 callr_3.7.3 crayon_1.4.1 RCurl_1.98-1.3 ## [37] jsonlite_1.8.4 scatterpie_0.1.7 ape_5.6-2 glue_1.6.2 ## [41] polyclip_1.10-0 gtable_0.3.0 zlibbioc_1.38.0 XVector_0.32.0 ## [45] webshot_0.5.2 scales_1.2.1 DBI_1.1.1 Rcpp_1.0.7 ## [49] viridisLite_0.4.0 progress_1.2.2 gridGraphics_0.5-1 tidytree_0.3.9 ## [53] bit_4.0.4 htmlwidgets_1.5.3 httr_1.4.2 fgsea_1.18.0 ## [57] RColorBrewer_1.1-2 ellipsis_0.3.2 pkgconfig_2.0.3 XML_3.99-0.6 ## [61] farver_2.1.0 sass_0.4.0 dbplyr_2.1.1 utf8_1.2.2 ## [65] later_1.2.0 ggplotify_0.1.0 tidyselect_1.1.1 rlang_1.1.1 ## [69] reshape2_1.4.4 munsell_0.5.0 tools_4.1.0 cachem_1.0.5 ## [73] downloader_0.4 cli_3.4.1 generics_0.1.0 RSQLite_2.2.7 ## [77] evaluate_0.15 stringr_1.5.0 fastmap_1.1.0 yaml_2.2.1 ## [81] ggtree_3.0.4 processx_3.8.1 knitr_1.39 bit64_4.0.5 ## [85] tidygraph_1.2.0 purrr_0.3.4 KEGGREST_1.32.0 ggraph_2.0.5 ## [89] nlme_3.1-152 mime_0.11 aplot_0.1.2 DO.db_2.9 ## [93] xml2_1.3.2 compiler_4.1.0 rstudioapi_0.13 filelock_1.0.2 ## [97] curl_4.3.2 png_0.1-7 treeio_1.16.2 statmod_1.4.36 ## [101] tibble_3.1.6 tweenr_1.0.2 bslib_0.4.2 stringi_1.7.8 ## [105] ps_1.6.0 highr_0.9 lattice_0.20-44 Matrix_1.5-3 ## [109] markdown_1.1 vctrs_0.5.1 pillar_1.6.2 lifecycle_1.0.3 ## [113] jquerylib_0.1.4 data.table_1.14.0 cowplot_1.1.1 bitops_1.0-7 ## [117] httpuv_1.6.1 patchwork_1.1.1 qvalue_2.24.0 R6_2.5.1 ## [121] promises_1.2.0.1 bookdown_0.34 gridExtra_2.3 MASS_7.3-54 ## [125] assertthat_0.2.1 rprojroot_2.0.2 withr_2.5.0 GenomeInfoDbData_1.2.6 ## [129] hms_1.1.0 grid_4.1.0 ggfun_0.0.5 tidyr_1.2.1 ## [133] rmarkdown_2.18 ggforce_0.3.3 "],["extracting-data-from-ncbi-gene-expression-omnibus-databse.html", "3 Extracting data from NCBI Gene Expression Omnibus databse", " 3 Extracting data from NCBI Gene Expression Omnibus databse library(here) library(GEOquery) library(dplyr) # require data from NCBI Gene Expression Omnibus (GEO) [database](https://www.ncbi.nlm.nih.gov/gds) # datasets: # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS5022 AMI # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS5074 AMI 48 hrs # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS4500 AML train set # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS4501 AML test set # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS4181 AML # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS4844 CF # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS3115 CHF # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS3383 chronic stress # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS838 CML # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS3503 exercise # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS4345 GI cancer muscle tissue # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS1412 hormone therapy # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS3005 IL1 and IL6 # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS5260 Psoriasis # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS3628 RA # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS5403 RA and OA # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS4266 renal transplant # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS5186 RIA # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS3898 social isolation # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS4193 SLE # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS3713 smoking # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS1436 smoking # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS1269 smoking # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS534 smoking # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS3318 scikle cell disease # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS4719 SLE # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS3920 MS # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS3886 MS # https://www.ncbi.nlm.nih.gov/sites/GDSbrowser?acc=GDS4270 UC "],["download-data-to-the-current-working-environment.html", "4 Download data to the current working environment 4.1 Summary of experiment 4.2 Assigning the expression and phenotype data", " 4 Download data to the current working environment Using GEOquery library to retrieve data from NCBI database. The GDS dataset is stored in the gds R4 class object. gds &lt;- getGEO(&quot;GDS3713&quot;) # gds@header # meta data of the experiment # gds@dataTable@table # expression data # gds@dataTable@columns # phenotype data structure of the gds object str(gds, max.level = 3) Formal class &#39;GDS&#39; [package &quot;GEOquery&quot;] with 3 slots ..@ gpl :Formal class &#39;GPL&#39; [package &quot;GEOquery&quot;] with 2 slots ..@ dataTable:Formal class &#39;GEODataTable&#39; [package &quot;GEOquery&quot;] with 2 slots ..@ header :List of 23 .. ..$ channel_count : chr &quot;1&quot; .. ..$ dataset_id : chr [1:2] &quot;GDS3713&quot; &quot;GDS3713&quot; .. ..$ description : chr [1:3] &quot;Analysis of peripheral circulating B cells from smoking and non-smoking healthy US white females. B cells are d&quot;| __truncated__ &quot;control&quot; &quot;cigarette smoke&quot; .. ..$ email : chr &quot;geo@ncbi.nlm.nih.gov&quot; .. ..$ feature_count : chr &quot;22283&quot; .. ..$ institute : chr &quot;NCBI NLM NIH&quot; .. ..$ name : chr &quot;Gene Expression Omnibus (GEO)&quot; .. ..$ order : chr &quot;none&quot; .. ..$ platform : chr &quot;GPL96&quot; .. ..$ platform_organism : chr &quot;Homo sapiens&quot; .. ..$ platform_technology_type: chr &quot;in situ oligonucleotide&quot; .. ..$ pubmed_id : chr &quot;20217071&quot; .. ..$ ref : chr &quot;Nucleic Acids Res. 2005 Jan 1;33 Database Issue:D562-6&quot; .. ..$ reference_series : chr &quot;GSE18723&quot; .. ..$ sample_count : chr &quot;79&quot; .. ..$ sample_id : chr [1:2] &quot;GSM464697,GSM464698,GSM464699,GSM464700,GSM464701,GSM464702,GSM464703,GSM464704,GSM464705,GSM464706,GSM464707,G&quot;| __truncated__ &quot;GSM464658,GSM464659,GSM464660,GSM464661,GSM464662,GSM464663,GSM464664,GSM464665,GSM464666,GSM464667,GSM464668,G&quot;| __truncated__ .. ..$ sample_organism : chr &quot;Homo sapiens&quot; .. ..$ sample_type : chr &quot;RNA&quot; .. ..$ title : chr &quot;Smoking effect on B lymphocytes in females&quot; .. ..$ type : chr [1:3] &quot;Expression profiling by array&quot; &quot;stress&quot; &quot;stress&quot; .. ..$ update_date : chr &quot;Jul 11 2010&quot; .. ..$ value_type : chr &quot;count&quot; .. ..$ web_link : chr &quot;http://www.ncbi.nlm.nih.gov/geo&quot; 4.1 Summary of experiment show(Meta(gds)) $channel_count [1] &quot;1&quot; $dataset_id [1] &quot;GDS3713&quot; &quot;GDS3713&quot; $description [1] &quot;Analysis of peripheral circulating B cells from smoking and non-smoking healthy US white females. B cells are directly associated with the onset and development of many smoking-induced diseases. Results provide insight into the molecular basis of B cell involvement in smoking-related pathogenesis.&quot; [2] &quot;control&quot; [3] &quot;cigarette smoke&quot; $email [1] &quot;geo@ncbi.nlm.nih.gov&quot; $feature_count [1] &quot;22283&quot; $institute [1] &quot;NCBI NLM NIH&quot; $name [1] &quot;Gene Expression Omnibus (GEO)&quot; $order [1] &quot;none&quot; $platform [1] &quot;GPL96&quot; $platform_organism [1] &quot;Homo sapiens&quot; $platform_technology_type [1] &quot;in situ oligonucleotide&quot; $pubmed_id [1] &quot;20217071&quot; $ref [1] &quot;Nucleic Acids Res. 2005 Jan 1;33 Database Issue:D562-6&quot; $reference_series [1] &quot;GSE18723&quot; $sample_count [1] &quot;79&quot; $sample_id [1] &quot;GSM464697,GSM464698,GSM464699,GSM464700,GSM464701,GSM464702,GSM464703,GSM464704,GSM464705,GSM464706,GSM464707,GSM464708,GSM464709,GSM464710,GSM464711,GSM464712,GSM464713,GSM464714,GSM464715,GSM464716,GSM464717,GSM464718,GSM464719,GSM464720,GSM464721,GSM464722,GSM464723,GSM464724,GSM464725,GSM464726,GSM464727,GSM464728,GSM464729,GSM464730,GSM464731,GSM464732,GSM464733,GSM464734,GSM464735,GSM464736&quot; [2] &quot;GSM464658,GSM464659,GSM464660,GSM464661,GSM464662,GSM464663,GSM464664,GSM464665,GSM464666,GSM464667,GSM464668,GSM464669,GSM464670,GSM464671,GSM464672,GSM464673,GSM464674,GSM464675,GSM464676,GSM464677,GSM464678,GSM464679,GSM464680,GSM464681,GSM464682,GSM464683,GSM464684,GSM464685,GSM464686,GSM464687,GSM464688,GSM464689,GSM464690,GSM464691,GSM464692,GSM464693,GSM464694,GSM464695,GSM464696&quot; $sample_organism [1] &quot;Homo sapiens&quot; $sample_type [1] &quot;RNA&quot; $title [1] &quot;Smoking effect on B lymphocytes in females&quot; $type [1] &quot;Expression profiling by array&quot; &quot;stress&quot; &quot;stress&quot; $update_date [1] &quot;Jul 11 2010&quot; $value_type [1] &quot;count&quot; $web_link [1] &quot;http://www.ncbi.nlm.nih.gov/geo&quot; 4.2 Assigning the expression and phenotype data The expression data is stored in the gds@dataTable@tabl with gene in The rows and subjects in the columns. The phenotype data is store at gds@dataTable@columns. expr &lt;- Table(gds) summary(expr[, 1:4]) ID_REF IDENTIFIER GSM464697 GSM464698 Length:22283 Length:22283 Min. : 1.53 Min. : 1.06 Class :character Class :character 1st Qu.: 65.44 1st Qu.: 74.40 Mode :character Mode :character Median : 221.78 Median : 243.15 Mean : 859.82 Mean : 752.89 3rd Qu.: 582.95 3rd Qu.: 600.85 Max. :51356.90 Max. :34387.10 pheno &lt;- Columns(gds) summary(pheno) sample stress description Length:79 cigarette smoke:39 Length:79 Class :character control :40 Class :character Mode :character Mode :character "],["convert-to-gds-to-expression-set.html", "5 convert to GDS to expression set", " 5 convert to GDS to expression set Converting the gds object to expression set will generate a series of sub documents, including an annotation file of the genes in the expression data. eset &lt;- GDS2eSet(gds) dim(pData(eset)) # pheno data, data.frame [1] 79 3 str(eset, max.level =4) Formal class &#39;ExpressionSet&#39; [package &quot;Biobase&quot;] with 7 slots ..@ experimentData :Formal class &#39;MIAME&#39; [package &quot;Biobase&quot;] with 13 slots .. .. ..@ name : chr &quot;&quot; .. .. ..@ lab : chr &quot;&quot; .. .. ..@ contact : chr &quot;&quot; .. .. ..@ title : chr &quot;Smoking effect on B lymphocytes in females&quot; .. .. ..@ abstract : chr &quot;Analysis of peripheral circulating B cells from smoking and non-smoking healthy US white females. B cells are d&quot;| __truncated__ .. .. ..@ url : chr &quot;&quot; .. .. ..@ pubMedIds : chr &quot;20217071&quot; .. .. ..@ samples : list() .. .. ..@ hybridizations : list() .. .. ..@ normControls : list() .. .. ..@ preprocessing : list() .. .. ..@ other :List of 23 .. .. ..@ .__classVersion__:Formal class &#39;Versions&#39; [package &quot;Biobase&quot;] with 1 slot ..@ assayData :&lt;environment: 0x2cb3d058&gt; ..@ phenoData :Formal class &#39;AnnotatedDataFrame&#39; [package &quot;Biobase&quot;] with 4 slots .. .. ..@ varMetadata :&#39;data.frame&#39;: 3 obs. of 1 variable: .. .. ..@ data :&#39;data.frame&#39;: 79 obs. of 3 variables: .. .. ..@ dimLabels : chr [1:2] &quot;sampleNames&quot; &quot;sampleColumns&quot; .. .. ..@ .__classVersion__:Formal class &#39;Versions&#39; [package &quot;Biobase&quot;] with 1 slot ..@ featureData :Formal class &#39;AnnotatedDataFrame&#39; [package &quot;Biobase&quot;] with 4 slots .. .. ..@ varMetadata :&#39;data.frame&#39;: 21 obs. of 2 variables: .. .. ..@ data :&#39;data.frame&#39;: 22283 obs. of 21 variables: .. .. ..@ dimLabels : chr [1:2] &quot;featureNames&quot; &quot;featureColumns&quot; .. .. ..@ .__classVersion__:Formal class &#39;Versions&#39; [package &quot;Biobase&quot;] with 1 slot ..@ annotation : chr(0) ..@ protocolData :Formal class &#39;AnnotatedDataFrame&#39; [package &quot;Biobase&quot;] with 4 slots .. .. ..@ varMetadata :&#39;data.frame&#39;: 0 obs. of 1 variable: .. .. ..@ data :&#39;data.frame&#39;: 79 obs. of 0 variables .. .. ..@ dimLabels : chr [1:2] &quot;sampleNames&quot; &quot;sampleColumns&quot; .. .. ..@ .__classVersion__:Formal class &#39;Versions&#39; [package &quot;Biobase&quot;] with 1 slot ..@ .__classVersion__:Formal class &#39;Versions&#39; [package &quot;Biobase&quot;] with 1 slot .. .. ..@ .Data:List of 4 .. .. ..$ names: chr [1:4] &quot;R&quot; &quot;Biobase&quot; &quot;eSet&quot; &quot;ExpressionSet&quot; # gene annotations annot_cols &lt;- eset@featureData@varMetadata annot_data &lt;- eset@featureData@data # experiment info # eset@experimentData # assay &lt;- eset@assayData Session Info sessionInfo() R version 4.1.0 (2021-05-18) Platform: x86_64-pc-linux-gnu (64-bit) Running under: Ubuntu 20.04.2 LTS Matrix products: default BLAS: /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0 locale: [1] LC_CTYPE=C.UTF-8 LC_NUMERIC=C LC_TIME=C.UTF-8 LC_COLLATE=C.UTF-8 [5] LC_MONETARY=C.UTF-8 LC_MESSAGES=C.UTF-8 LC_PAPER=C.UTF-8 LC_NAME=C [9] LC_ADDRESS=C LC_TELEPHONE=C LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C attached base packages: [1] parallel stats4 stats graphics grDevices utils datasets methods base other attached packages: [1] GEOquery_2.60.0 dplyr_1.0.10 limma_3.48.2 DT_0.26 [5] biomaRt_2.48.2 org.Hs.eg.db_3.13.0 AnnotationDbi_1.54.1 IRanges_2.26.0 [9] S4Vectors_0.30.0 Biobase_2.52.0 BiocGenerics_0.38.0 DOSE_3.18.3 [13] enrichplot_1.12.3 clusterProfiler_4.0.5 here_1.0.1 loaded via a namespace (and not attached): [1] shadowtext_0.1.1 fastmatch_1.1-3 servr_0.22 BiocFileCache_2.0.0 [5] plyr_1.8.6 igraph_1.2.6 lazyeval_0.2.2 splines_4.1.0 [9] BiocParallel_1.26.1 crosstalk_1.1.1 GenomeInfoDb_1.28.1 ggplot2_3.4.0 [13] digest_0.6.27 yulab.utils_0.0.4 htmltools_0.5.5 GOSemSim_2.18.1 [17] viridis_0.6.1 GO.db_3.13.0 fansi_0.5.0 magrittr_2.0.3 [21] memoise_2.0.1 scriptResume_0.1.4 tzdb_0.1.2 readr_2.0.0 [25] Biostrings_2.60.1 graphlayouts_0.8.0 vroom_1.5.3 prettyunits_1.1.1 [29] colorspace_2.0-2 blob_1.2.2 rappdirs_0.3.3 ggrepel_0.9.1 [33] xfun_0.39 callr_3.7.3 crayon_1.4.1 RCurl_1.98-1.3 [37] jsonlite_1.8.4 scatterpie_0.1.7 ape_5.6-2 glue_1.6.2 [41] polyclip_1.10-0 gtable_0.3.0 zlibbioc_1.38.0 XVector_0.32.0 [45] webshot_0.5.2 scales_1.2.1 DBI_1.1.1 Rcpp_1.0.7 [49] viridisLite_0.4.0 progress_1.2.2 gridGraphics_0.5-1 tidytree_0.3.9 [53] bit_4.0.4 htmlwidgets_1.5.3 httr_1.4.2 fgsea_1.18.0 [57] RColorBrewer_1.1-2 ellipsis_0.3.2 pkgconfig_2.0.3 XML_3.99-0.6 [61] farver_2.1.0 sass_0.4.0 dbplyr_2.1.1 utf8_1.2.2 [65] later_1.2.0 ggplotify_0.1.0 tidyselect_1.1.1 rlang_1.1.1 [69] reshape2_1.4.4 munsell_0.5.0 tools_4.1.0 cachem_1.0.5 [73] downloader_0.4 cli_3.4.1 generics_0.1.0 RSQLite_2.2.7 [77] evaluate_0.15 stringr_1.5.0 fastmap_1.1.0 yaml_2.2.1 [81] ggtree_3.0.4 processx_3.8.1 knitr_1.39 bit64_4.0.5 [85] tidygraph_1.2.0 purrr_0.3.4 KEGGREST_1.32.0 ggraph_2.0.5 [89] nlme_3.1-152 mime_0.11 aplot_0.1.2 DO.db_2.9 [93] xml2_1.3.2 compiler_4.1.0 rstudioapi_0.13 filelock_1.0.2 [97] curl_4.3.2 png_0.1-7 treeio_1.16.2 statmod_1.4.36 [101] tibble_3.1.6 tweenr_1.0.2 bslib_0.4.2 stringi_1.7.8 [105] ps_1.6.0 highr_0.9 lattice_0.20-44 Matrix_1.5-3 [109] markdown_1.1 vctrs_0.5.1 pillar_1.6.2 lifecycle_1.0.3 [113] jquerylib_0.1.4 data.table_1.14.0 cowplot_1.1.1 bitops_1.0-7 [117] httpuv_1.6.1 patchwork_1.1.1 qvalue_2.24.0 R6_2.5.1 [121] promises_1.2.0.1 bookdown_0.34 gridExtra_2.3 MASS_7.3-54 [125] assertthat_0.2.1 rprojroot_2.0.2 withr_2.5.0 GenomeInfoDbData_1.2.6 [129] hms_1.1.0 grid_4.1.0 ggfun_0.0.5 tidyr_1.2.1 [133] rmarkdown_2.18 ggforce_0.3.3 # Markdown -------------------------------------------------------- # rmarkdown::render(&#39;src/02_req_data.R&#39;, output_dir = &#39;output&#39;) # knitr::spin(&#39;src/02_req_data.R&#39;, format = &#39;Rmd&#39;, knit = FALSE) "],["query-bioloical-pathway-databases.html", "6 Query bioloical pathway databases", " 6 Query bioloical pathway databases library(here) require(clusterProfiler) require(enrichplot) require(DOSE) require(org.Hs.eg.db) library(biomaRt) library(DT) "],["study-dataset.html", "7 Study dataset", " 7 Study dataset In this tutorial, I still use the pulic smoking study dataset from NCBI GEO database - GDS3713 (GSE18723). rst &lt;- readRDS(file.path(here(), &quot;data/de_rst.rds&quot;)) annot &lt;- readRDS(file.path(here(), &quot;data/annot.rds&quot;)) %&gt;% data.frame() "],["annotation-of-genes.html", "8 Annotation of genes", " 8 Annotation of genes The GDS3713 dataset comes with an annotation file that has information for genes in the array: cat(paste0(names(annot), collapse = &#39;\\t&#39;)) ID Gene.title Gene.symbol Gene.ID UniGene.title UniGene.symbol UniGene.ID Nucleotide.Title GI GenBank.Accession Platform_CLONEID Platform_ORF Platform_SPOTID Chromosome.location Chromosome.annotation GO.Function GO.Process GO.Component GO.Function.ID GO.Process.ID GO.Component.ID One can directly query a specific gene from this file. For example, we can look up the ICOSLG information. datatable(annot[which(annot$Gene.symbol == &quot;ICOSLG&quot;), ], rownames = F ) However, most of time, we don’t have such a file that comes with the trancriptomic data. We will then need to annotate the genes. "],["convert-gene-symbol-to-gene-id-using-biomart..html", "9 Convert gene symbol to gene ID using biomaRt. 9.1 1. Connect to the selected BioMart database using useEnsembl function. 9.2 2. Annotate genes 9.3 Alternative methods for annotation", " 9 Convert gene symbol to gene ID using biomaRt. Since many pathway database requires entrez gene IDs as entries and most of sequencing/ microarray output provides gene symbols or ensembl IDs, we’ll need to convert gene symbol to entrez IDs for the pathway analysis. We can query from the ensembl site manually. Or we can do better usingbiomaRtpackage. For a full tutorial of biomaRt package, see here. It covers some more advanced use case. Here I only cover basic usage of this package. 9.1 1. Connect to the selected BioMart database using useEnsembl function. Before connecting to a specific database, we can first check available databases. 9.1.1 List of available BioMart databases hosted by Ensembl # available database datatable(listEnsembl()) # available biological species for the gene databases mart &lt;- useEnsembl(&quot;genes&quot;, mirror = &#39;www&#39;) datatable(listDatasets(mart)) Since we want to convert gene symbol to Entrez gene IDs in human subjects, we select biomart = 'genes' and dataset= 'hsapiens_gene_ensembl'. Use useEnsembl function to setup the connection with ensembl site host. # convert from gene symbol to gene ID ensembl &lt;- useEnsembl( biomart = &quot;genes&quot;, dataset = &quot;hsapiens_gene_ensembl&quot;, mirror = &quot;www&quot; ) 9.2 2. Annotate genes Here instead of selecting genes in a biological pathway, I simply randomly choose some genes in the dataset. set.seed(123) gs1 &lt;- sample(rst$ID, 10) gs2 &lt;- sample(rst$ID, 10) Here I choose five most significantly differentially expressed genes, five genes not differentially expressed. gs3 &lt;- c(head(rst$ID, 5), tail(rst$ID, 5)) print(glue::glue(&#39;geneset 1: {paste0(gs1, collapse = &quot;, &quot;)} geneset 2: {paste0(gs2, collapse =&quot;, &quot;)}\\ngeneset 3: {paste0(gs3, collapse =&quot;, &quot;)}&#39;)) geneset 1: PLAGL2, DYX1C1-CCPG1, HK3, TLR1, GEMIN2, KPNB1, COX7C, VDAC2, MEFV, EEF1A1 geneset 2: ALX4, CYB5A, FGF12, CLEC4A, STAP1, HSP90AA1, RPF1, UBE2Q1, YTHDC1, SLC4A3 geneset 3: SCAF11, CBFB, EBP, DDX3X, RAB2A, C19orf54, ATP2B3, ADGRG6, PHF1, BCL2L14 Retreive the annotated file with getBM function. Since we use gene symbols to match aginst gene IDs, we’ll need to specify the type of input data in the filter argument (filters = \"hgnc_symbol\"). We would like to output the hgnc_symbol,entrezgene_id reference. annotgs3 &lt;- getBM( attributes = c(&quot;hgnc_symbol&quot;, &quot;entrezgene_id&quot;), filters = &quot;hgnc_symbol&quot;, values = gs3, mart = ensembl ) print(annotgs3) hgnc_symbol entrezgene_id 1 ADGRG6 57211 2 ATP2B3 492 3 BCL2L14 79370 4 C19orf54 284325 5 CBFB 865 6 DDX3X 1654 7 EBP 10682 8 PHF1 5252 9 RAB2A 5862 10 SCAF11 9169 Note that not all gene symbols can be perfectly match against gene ID. Alternatively, you can annotate all the gene in the dataset then extract the ones in the genesets. For simplicity, I removed duplicated genes of which have multiple probes correspond to the same gene (isoforms). In practice, the removal of these isoforms should be done with examination of coefficient variation (CV). all_genes &lt;- rst$ID[!duplicated(rst$ID)] Upon removal of duplicates, there are 14063 genes left in the dataset. We annotate these genes. annot_all &lt;- getBM( attributes = c(&quot;hgnc_symbol&quot;, &quot;entrezgene_id&quot;), filters = &quot;hgnc_symbol&quot;, values = all_genes, mart = ensembl ) 9.3 Alternative methods for annotation Alternatively one can use bitr function from clusterProfiler package. Here we need to specify the database for curation. This requires the pacakge org.Hs.eg.db. If you decide to go with method, make sure to update this package often to obtain the most current information. The org.Hs.eg.db package is updated biannually. bitr(gs1, fromType = &quot;SYMBOL&quot;, toType = c(&quot;ENTREZID&quot;, &quot;SYMBOL&quot;), OrgDb = org.Hs.eg.db ) SYMBOL ENTREZID 1 PLAGL2 5326 3 HK3 3101 4 TLR1 7096 5 GEMIN2 8487 6 KPNB1 3837 7 COX7C 1350 8 VDAC2 7417 9 MEFV 4210 10 EEF1A1 1915 "],["curate-biological-functions.html", "10 Curate biological functions", " 10 Curate biological functions Upon selection genes of interest, we can start to curate the biological functions of these genes. The most popular databases are GO, KEGG, Reactome, etc. For full understanding the property of each of these databases, see these references [xxx]. For example, I’d like to query the biological functions of genes in the set 3 . One can use the groupGO function to look up biological functions: MF: Molecular Function molecular activities of gene products CC: Cellular Component where gene products are active BP: Biological Process pathways and larger processes made up of the activities of multiple gene products Additionally, one can look up onto KEGG, WikiPathway, Reactome, Diease Ontology (DO), Medical Subject Headings (MeSH), Molecular Signatures Database (MSigDb). I didn’t find any ready to use functions from clusterProfile package,except for GO query. However, personally, I don’t think statiticians are experts to interpret the finding in biological sense. Since this is less of interest for analysts, the clusterProfiler simplifed this curation process and combined with the tests (ORA, GSEA) in their function construction. For details see separate files. ggo &lt;- groupGO( gene = as.character(annotgs3$entrezgene_id), OrgDb = org.Hs.eg.db, ont = &quot;BP&quot;, level = 3, readable = TRUE ) tail(ggo) ID GO:0051410 GO:0051410 GO:0061687 GO:0061687 GO:0071722 GO:0071722 GO:0140330 GO:0140330 GO:1990961 GO:1990961 GO:0031214 GO:0031214 Description Count GO:0051410 detoxification of nitrogen compound 0 GO:0061687 detoxification of inorganic compound 0 GO:0071722 detoxification of arsenic-containing substance 0 GO:0140330 xenobiotic detoxification by transmembrane export across the cell outer membrane 0 GO:1990961 xenobiotic detoxification by transmembrane export across the plasma membrane 0 GO:0031214 biomineral tissue development 0 GeneRatio geneID GO:0051410 0/10 GO:0061687 0/10 GO:0071722 0/10 GO:0140330 0/10 GO:1990961 0/10 GO:0031214 0/10 "],["reference.html", "11 Reference", " 11 Reference Session Info sessionInfo() R version 4.1.0 (2021-05-18) Platform: x86_64-pc-linux-gnu (64-bit) Running under: Ubuntu 20.04.2 LTS Matrix products: default BLAS: /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0 locale: [1] LC_CTYPE=C.UTF-8 LC_NUMERIC=C LC_TIME=C.UTF-8 LC_COLLATE=C.UTF-8 [5] LC_MONETARY=C.UTF-8 LC_MESSAGES=C.UTF-8 LC_PAPER=C.UTF-8 LC_NAME=C [9] LC_ADDRESS=C LC_TELEPHONE=C LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C attached base packages: [1] parallel stats4 stats graphics grDevices utils datasets methods base other attached packages: [1] GEOquery_2.60.0 dplyr_1.0.10 limma_3.48.2 DT_0.26 [5] biomaRt_2.48.2 org.Hs.eg.db_3.13.0 AnnotationDbi_1.54.1 IRanges_2.26.0 [9] S4Vectors_0.30.0 Biobase_2.52.0 BiocGenerics_0.38.0 DOSE_3.18.3 [13] enrichplot_1.12.3 clusterProfiler_4.0.5 here_1.0.1 loaded via a namespace (and not attached): [1] shadowtext_0.1.1 fastmatch_1.1-3 servr_0.22 BiocFileCache_2.0.0 [5] plyr_1.8.6 igraph_1.2.6 lazyeval_0.2.2 splines_4.1.0 [9] BiocParallel_1.26.1 crosstalk_1.1.1 GenomeInfoDb_1.28.1 ggplot2_3.4.0 [13] digest_0.6.27 yulab.utils_0.0.4 htmltools_0.5.5 GOSemSim_2.18.1 [17] viridis_0.6.1 GO.db_3.13.0 fansi_0.5.0 magrittr_2.0.3 [21] memoise_2.0.1 scriptResume_0.1.4 tzdb_0.1.2 readr_2.0.0 [25] Biostrings_2.60.1 graphlayouts_0.8.0 vroom_1.5.3 prettyunits_1.1.1 [29] colorspace_2.0-2 blob_1.2.2 rappdirs_0.3.3 ggrepel_0.9.1 [33] xfun_0.39 callr_3.7.3 crayon_1.4.1 RCurl_1.98-1.3 [37] jsonlite_1.8.4 scatterpie_0.1.7 ape_5.6-2 glue_1.6.2 [41] polyclip_1.10-0 gtable_0.3.0 zlibbioc_1.38.0 XVector_0.32.0 [45] webshot_0.5.2 scales_1.2.1 DBI_1.1.1 Rcpp_1.0.7 [49] viridisLite_0.4.0 progress_1.2.2 gridGraphics_0.5-1 tidytree_0.3.9 [53] bit_4.0.4 htmlwidgets_1.5.3 httr_1.4.2 fgsea_1.18.0 [57] RColorBrewer_1.1-2 ellipsis_0.3.2 pkgconfig_2.0.3 XML_3.99-0.6 [61] farver_2.1.0 sass_0.4.0 dbplyr_2.1.1 utf8_1.2.2 [65] later_1.2.0 ggplotify_0.1.0 tidyselect_1.1.1 rlang_1.1.1 [69] reshape2_1.4.4 munsell_0.5.0 tools_4.1.0 cachem_1.0.5 [73] downloader_0.4 cli_3.4.1 generics_0.1.0 RSQLite_2.2.7 [77] evaluate_0.15 stringr_1.5.0 fastmap_1.1.0 yaml_2.2.1 [81] ggtree_3.0.4 processx_3.8.1 knitr_1.39 bit64_4.0.5 [85] tidygraph_1.2.0 purrr_0.3.4 KEGGREST_1.32.0 ggraph_2.0.5 [89] nlme_3.1-152 mime_0.11 aplot_0.1.2 DO.db_2.9 [93] xml2_1.3.2 compiler_4.1.0 rstudioapi_0.13 filelock_1.0.2 [97] curl_4.3.2 png_0.1-7 treeio_1.16.2 statmod_1.4.36 [101] tibble_3.1.6 tweenr_1.0.2 bslib_0.4.2 stringi_1.7.8 [105] ps_1.6.0 highr_0.9 lattice_0.20-44 Matrix_1.5-3 [109] markdown_1.1 vctrs_0.5.1 pillar_1.6.2 lifecycle_1.0.3 [113] jquerylib_0.1.4 data.table_1.14.0 cowplot_1.1.1 bitops_1.0-7 [117] httpuv_1.6.1 patchwork_1.1.1 qvalue_2.24.0 R6_2.5.1 [121] promises_1.2.0.1 bookdown_0.34 gridExtra_2.3 codetools_0.2-18 [125] MASS_7.3-54 assertthat_0.2.1 rprojroot_2.0.2 withr_2.5.0 [129] GenomeInfoDbData_1.2.6 hms_1.1.0 grid_4.1.0 ggfun_0.0.5 [133] tidyr_1.2.1 rmarkdown_2.18 ggforce_0.3.3 "],["over-representation-analysis.html", "12 Over-representation Analysis", " 12 Over-representation Analysis library(here) library(DT) library(clusterProfiler) library(org.Hs.eg.db) "],["experiment-data.html", "13 Experiment Data", " 13 Experiment Data This pathway analysis will be using the smoking study data GDS3713 (GSE18723). The results from DEA will be used for ORA. rst &lt;- readRDS(file.path(here(), &quot;data/de_rst.rds&quot;)) gene_ids &lt;- readRDS(file.path(here(), &quot;data/gene_id.rds&quot;)) In this micro-array data due to that there are multiple probes match to the same gene. For illustration of the PA purpose I simply removed the duplicated gene probes.In pratice these duplicates should be removed with cautions. rm_idx &lt;- duplicated(rst$ID) rst &lt;- rst[!rm_idx, ] This leaves 14063 genes in the dataset. "],["gene-set-selection.html", "14 Gene set selection 14.1 Define differentially expressed gene", " 14 Gene set selection Normally these gene sets should represent major players in biological pathways. This can be achieved through the query from the biological databases or from other analytical approach such as co-expression analysis. For illustration purpose, here I randomly select 10 genes for each gene set. set.seed(123) gs1 &lt;- sample(rst$ID, 10) Here I choose five most significantly differentially expressed genes, five genes not differentially expressed. gs2 &lt;- c(head(rst$ID, 5), tail(rst$ID, 5)) print(glue::glue(&#39;geneset 1: {paste0(gs1, collapse = &quot;, &quot;)} geneset 2: {paste0(gs2, collapse =&quot;, &quot;)}&#39;)) geneset 1: NCAPD3, CA4, RCL1, SNRPA, CDCA3, IL24, SPAG9, AK024868, RTN4, AF052091 geneset 2: SCAF11, CBFB, EBP, DDX3X, RAB2A, ACOT13, NAP1L3, C19orf54, ADGRG6, BCL2L14 14.1 Define differentially expressed gene Here I define differentially expressed genes with following criterion: adjusted p-value &lt; 0.001 log fold change &gt; 5 These thresholds are not fixed can be varied depending on the context. Or it can be obtained from other analytical methods. rst &lt;- rst %&gt;% mutate( de = adj.P.Val &lt; 0.001 &amp; abs(logFC) &gt; 5, gs1 = ID %in% gs1, gs2 = ID %in% gs2, ) table(rst[, c(&quot;gs1&quot;, &quot;de&quot;)]) de gs1 FALSE TRUE FALSE 13450 603 TRUE 10 0 table(rst[, c(&quot;gs2&quot;, &quot;de&quot;)]) de gs2 FALSE TRUE FALSE 13455 598 TRUE 5 5 "],["over-representation-test.html", "15 Over-representation test 15.1 Gene set 1 15.2 Gene set 2", " 15 Over-representation test The null hypothesis of ORA test: being differentally expressed and belong to a particular pathway (gene set) are independent. Common statistical tests: chi-square test, Fisher’s exact test. Note that when counts in a cell of a contigency table is small, chi-square approximation may not be accurate. The following examples tests the hypothesis for the gene sets described above . Note that this is different from the R package example below. 15.1 Gene set 1 conttab_gs1 &lt;- as.table(table(rst[, c(&quot;gs1&quot;, &quot;de&quot;)])) chisq.test(conttab_gs1) Pearson&#39;s Chi-squared test with Yates&#39; continuity correction data: conttab_gs1 X-squared = 4.4456e-30, df = 1, p-value = 1 fisher.test(conttab_gs1, alternative = &quot;greater&quot;) Fisher&#39;s Exact Test for Count Data data: conttab_gs1 p-value = 1 alternative hypothesis: true odds ratio is greater than 1 95 percent confidence interval: 0 Inf sample estimates: odds ratio 0 15.2 Gene set 2 conttab_gs2 &lt;- as.table(table(rst[, c(&quot;gs2&quot;, &quot;de&quot;)])) chisq.test(conttab_gs2) Pearson&#39;s Chi-squared test with Yates&#39; continuity correction data: conttab_gs2 X-squared = 40.416, df = 1, p-value = 2.053e-10 fisher.test(conttab_gs2, alternative = &quot;greater&quot;) Fisher&#39;s Exact Test for Count Data data: conttab_gs2 p-value = 3.002e-05 alternative hypothesis: true odds ratio is greater than 1 95 percent confidence interval: 6.414538 Inf sample estimates: odds ratio 22.48251 "],["over-respensentation-analysis-from-r-package.html", "16 Over-respensentation analysis from R package 16.1 Test set up and Result interpretations 16.2 Examples", " 16 Over-respensentation analysis from R package The advantage of ORA using R packages, most popular one clusterProfile (which is the fusion of a few packages) is that the functions combine the step of database query and the step of testing in one go. The clusterProfile package currently provide following biological database. As shown in the graph, the ORA tests with different db queries are prefixed with enrich, such as enrichGO, enrichDO. Note that these functions are different than the test above. They first query the biological process databases and find the genes lie in the pathway(s). Then it will perform the test to see if the genes in the pathways are differentially expressed compared to the background genes. For example, I’m interested in the top 10 most significantly differentially expressed genes. I would like to query the pathways that these genes involve in then test if these pathways are significantly differentially expressed. gs3 &lt;- head(rst$ID, 10) gs3_ids &lt;- gene_ids[which(gene_ids$hgnc_symbol %in% gs3), &quot;entrezgene_id&quot;] %&gt;% as.character() Gene IDs of geneset 3: 865, 1654, 10682, 79157, 5862, 9169 Note that not all gene symols can be mapped to the gene IDs In this dataset, we have 12222 non-duplicated gene IDs. 16.1 Test set up and Result interpretations Setup parameters: gene: a character vector of gene entrez ID in a gene set to be tested universe: a character vector of gene entrez ID in the background gene set ontology type: biological ontology type. This varies from different reference database. Check specific database for details. reference database: some function requires the input of database. one can either use the connection to online db or download to local. This takes big storage space. Interpretation of results: I use the result from GO enrichment analysis for illustration. This applies to the analytical results queried from other databases. From the result object, one can see that the these top genes were mapped onto 94 gene sets (GO terms). Out of these 94 sets, 31 were tested significant. The significance cutoff set up is illustrated in the result object. To interpret the result table, take the examplle of GO term GO:0043186 as an example. This GO term contains 10 genes, out of the 10 genes, only one gene is found in our queried list, which contains 6 genes. So the GeneRatio is 1/6. The pathway. In the background gene set (BgRatio), there are 10 out of 11599 genes. From this we can construct a contingency table below and perform the Fisher test: GO term non-Go term geneset 1 5 background 9 11583 tab &lt;- as.table(matrix(c(1, 9, 5, 11583), ncol = 2)) fisher.test(tab, alternative = &quot;greater&quot;) Fisher&#39;s Exact Test for Count Data data: tab p-value = 0.005163 alternative hypothesis: true odds ratio is greater than 1 95 percent confidence interval: 9.965036 Inf sample estimates: odds ratio 253.8776 16.2 Examples I list the example queries in the mostly used databases. If not specified, all the functions are from the clusterProfile package. 16.2.1 GO Gene Ontology rst_go &lt;- enrichGO(gs3_ids, universe = as.character(gene_ids$entrezgene_id), OrgDb = org.Hs.eg.db, ont = &quot;CC&quot;, pAdjustMethod = &quot;BH&quot;, readable = F ) str(rst_go, max.level = 2) Formal class &#39;enrichResult&#39; [package &quot;DOSE&quot;] with 14 slots ..@ result :&#39;data.frame&#39;: 31 obs. of 9 variables: ..@ pvalueCutoff : num 0.05 ..@ pAdjustMethod: chr &quot;BH&quot; ..@ qvalueCutoff : num 0.2 ..@ organism : chr &quot;Homo sapiens&quot; ..@ ontology : chr &quot;CC&quot; ..@ gene : chr [1:6] &quot;865&quot; &quot;1654&quot; &quot;10682&quot; &quot;79157&quot; ... ..@ keytype : chr &quot;ENTREZID&quot; ..@ universe : chr [1:11599] &quot;2023&quot; &quot;2026&quot; &quot;2027&quot; &quot;1069&quot; ... ..@ gene2Symbol : chr(0) ..@ geneSets :List of 94 ..@ readable : logi FALSE ..@ termsim : num[0 , 0 ] ..@ method : chr(0) datatable(rst_go@result) rst_go@geneSets[&quot;GO:0043186&quot;] $`GO:0043186` [1] &quot;1654&quot; &quot;6637&quot; &quot;8653&quot; &quot;9271&quot; &quot;9931&quot; &quot;11022&quot; &quot;23589&quot; &quot;54514&quot; &quot;55124&quot; &quot;56165&quot; 16.2.2 KEGG Kyoto Encyclopedia of Genes and Genomes I ran into bug from the older version of clusterProfiler. In order to get this function work, update R version and upgrade DOSE package if you use online reference. Alternatively download KEGG reference and set use_internal_data = TRUE. I can’t upgrade R in my local enviroment and don’t have space to download massive data. So I won’t be able to illustrate KEGG here. rst_kegg &lt;- enrichKEGG(gs3_ids, universe = as.character(gene_ids$entrezgene_id), minGSSize = 1, pvalueCutoff = 0.3, organism = &quot;hsa&quot;, use_internal_data = F ) KEGG module rst_mkegg &lt;- enrichMKEGG(gs3_ids, universe = as.character(gene_ids$entrezgene_id), organism = &quot;hsa&quot; ) str(rst_mkegg, max.levels = 1) Formal class &#39;enrichResult&#39; [package &quot;DOSE&quot;] with 14 slots ..@ result :&#39;data.frame&#39;: 1 obs. of 9 variables: .. ..$ ID : chr &quot;M00101&quot; .. ..$ Description: chr &quot;Cholesterol biosynthesis, squalene 2,3-epoxide =&gt; cholesterol&quot; .. ..$ GeneRatio : chr &quot;1/1&quot; .. ..$ BgRatio : chr &quot;10/659&quot; .. ..$ pvalue : num 0.0152 .. ..$ p.adjust : num 0.0152 .. ..$ qvalue : logi NA .. ..$ geneID : chr &quot;10682&quot; .. ..$ Count : int 1 ..@ pvalueCutoff : num 0.05 ..@ pAdjustMethod: chr &quot;BH&quot; ..@ qvalueCutoff : num 0.2 ..@ organism : chr &quot;hsa&quot; ..@ ontology : chr &quot;MKEGG&quot; ..@ gene : chr [1:6] &quot;865&quot; &quot;1654&quot; &quot;10682&quot; &quot;79157&quot; ... ..@ keytype : chr &quot;UNKNOWN&quot; ..@ universe : chr [1:659] &quot;3101&quot; &quot;3098&quot; &quot;3099&quot; &quot;80201&quot; ... ..@ gene2Symbol : chr(0) ..@ geneSets :List of 2 .. ..$ M00101: chr [1:10] &quot;4047&quot; &quot;7108&quot; &quot;3930&quot; &quot;6307&quot; ... .. ..$ M00917: chr [1:5] &quot;7108&quot; &quot;10682&quot; &quot;6309&quot; &quot;1717&quot; ... ..@ readable : logi FALSE ..@ termsim : num[0 , 0 ] ..@ method : chr(0) datatable(rst_mkegg@result, rownames = F) 16.2.3 WikiPathways WikiPathways enrichWP(gs3_ids, organism = &quot;Homo sapiens&quot;, universe = as.character(gene_ids$entrezgene_id) ) # # over-representation test # #...@organism Homo sapiens #...@ontology WikiPathways #...@keytype ENTREZID #...@gene chr [1:6] &quot;865&quot; &quot;1654&quot; &quot;10682&quot; &quot;79157&quot; &quot;5862&quot; &quot;9169&quot; #...pvalues adjusted by &#39;BH&#39; with cutoff &lt;0.05 #...0 enriched terms found #...Citation T Wu, E Hu, S Xu, M Chen, P Guo, Z Dai, T Feng, L Zhou, W Tang, L Zhan, X Fu, S Liu, X Bo, and G Yu. clusterProfiler 4.0: A universal enrichment tool for interpreting omics data. The Innovation. 2021, 2(3):100141 16.2.4 Reactome Reactome rst_react &lt;- ReactomePA::enrichPathway(gs3_ids, universe = as.character(gene_ids$entrezgene_id), qvalueCutoff = 0.1 ) str(rst_react, max.level = 2) Formal class &#39;enrichResult&#39; [package &quot;DOSE&quot;] with 14 slots ..@ result :&#39;data.frame&#39;: 23 obs. of 9 variables: ..@ pvalueCutoff : num 0.05 ..@ pAdjustMethod: chr &quot;BH&quot; ..@ qvalueCutoff : num 0.1 ..@ organism : chr &quot;human&quot; ..@ ontology : chr &quot;Reactome&quot; ..@ gene : chr [1:6] &quot;865&quot; &quot;1654&quot; &quot;10682&quot; &quot;79157&quot; ... ..@ keytype : chr &quot;ENTREZID&quot; ..@ universe : chr [1:7934] &quot;10019&quot; &quot;10112&quot; &quot;10125&quot; &quot;1017&quot; ... ..@ gene2Symbol : chr(0) ..@ geneSets :List of 51 ..@ readable : logi FALSE ..@ termsim : num[0 , 0 ] ..@ method : chr(0) datatable(rst_react@result, rownames = F) 16.2.5 DO Disease Ontology cache &lt;- T DOSE::enrichDO(gs3_ids, universe = as.character(gene_ids$entrezgene_id) ) # # over-representation test # #...@organism Homo sapiens #...@ontology DO #...@keytype ENTREZID #...@gene chr [1:6] &quot;865&quot; &quot;1654&quot; &quot;10682&quot; &quot;79157&quot; &quot;5862&quot; &quot;9169&quot; #...pvalues adjusted by &#39;BH&#39; with cutoff &lt;0.05 #...0 enriched terms found #...Citation Guangchuang Yu, Li-Gen Wang, Guang-Rong Yan, Qing-Yu He. DOSE: an R/Bioconductor package for Disease Ontology Semantic and Enrichment analysis. Bioinformatics 2015, 31(4):608-609 16.2.6 DisGeNET DisGeNET rst_dgn &lt;- DOSE::enrichDGN(gs3_ids, universe = as.character(gene_ids$entrezgene_id), readable = F ) str(rst_dgn, max.level = 2) Formal class &#39;enrichResult&#39; [package &quot;DOSE&quot;] with 14 slots ..@ result :&#39;data.frame&#39;: 281 obs. of 9 variables: ..@ pvalueCutoff : num 0.05 ..@ pAdjustMethod: chr &quot;BH&quot; ..@ qvalueCutoff : num 0.2 ..@ organism : chr &quot;Homo sapiens&quot; ..@ ontology : chr &quot;DisGeNET&quot; ..@ gene : chr [1:6] &quot;865&quot; &quot;1654&quot; &quot;10682&quot; &quot;79157&quot; ... ..@ keytype : chr &quot;ENTREZID&quot; ..@ universe : chr [1:11429] &quot;1468&quot; &quot;4210&quot; &quot;54808&quot; &quot;72&quot; ... ..@ gene2Symbol : chr(0) ..@ geneSets :List of 475 ..@ readable : logi FALSE ..@ termsim : num[0 , 0 ] ..@ method : chr(0) datatable(rst_dgn@result, rownames = F) 16.2.7 MeSH MeSH The enrichement test function requires the feed the reference argument. One can either download the whole reference or connect on online db. The following code will create a local database in the cache directory. The location of the local cache can be found (and updated) with getAnnotationHubCache and setAnnotationHubCache; removeCache removes all cache resources. annot &lt;- AnnotationHub::AnnotationHub(localHub = F) print(annot) # query annotation hub for MeSH database hsa &lt;- AnnotationHub::query(annot, c(&quot;MeSHDb&quot;, &quot;Homo sapiens&quot;)) print(str(hsa)) # download rosources to local cache directory ref_hsa &lt;- hsa[[1]] MeSHDB &lt;- MeSHDbi::MeSHDb(ref_hsa) Otherwise one can install MeSH.Hsa.eg.db package in the local environment. # require installation of `MeSH.Hsa.eg.db` package. # replace `MeSHDb = MeSHDB` if using local reference database. rst_mesh &lt;- meshes::enrichMeSH(gs3_ids, MeSHDb = &quot;MeSH.Hsa.eg.db&quot; ) str(rst_mesh, max.level = 2) Formal class &#39;enrichResult&#39; [package &quot;DOSE&quot;] with 14 slots ..@ result :&#39;data.frame&#39;: 28 obs. of 9 variables: ..@ pvalueCutoff : num 0.05 ..@ pAdjustMethod: chr &quot;BH&quot; ..@ qvalueCutoff : num 0.2 ..@ organism : chr &quot;Human&quot; ..@ ontology : chr &quot;MeSH&quot; ..@ gene : chr [1:6] &quot;865&quot; &quot;1654&quot; &quot;10682&quot; &quot;79157&quot; ... ..@ keytype : chr &quot;UNKNOWN&quot; ..@ universe : chr [1:16528] &quot;11093&quot; &quot;4867&quot; &quot;5068&quot; &quot;6868&quot; ... ..@ gene2Symbol : chr(0) ..@ geneSets :List of 61 ..@ readable : logi FALSE ..@ termsim : num[0 , 0 ] ..@ method : chr(0) datatable(rst_mesh@result, rownames = F) # library(RDAVIDWebService) # enrichDAVID(gs3_ids, # universe = as.character(gene_ids$entrezgene_id) # ) "],["pros-and-cons-of-ora.html", "17 Pros and Cons of ORA", " 17 Pros and Cons of ORA Simple and straitforward can be used for exploratory analysis when there’s no prior hypothesis about any biological mechanism. However, can not infer the directly of differentially expressed pathway e.g. up-regulated or down-regulated. This is not so helpful when particularly interested in the pathways that a drug modulate. does not address the intercorelations of genes. "],["reference-1.html", "18 Reference", " 18 Reference Session Info sessionInfo() R version 4.1.0 (2021-05-18) Platform: x86_64-pc-linux-gnu (64-bit) Running under: Ubuntu 20.04.2 LTS Matrix products: default BLAS: /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0 locale: [1] LC_CTYPE=C.UTF-8 LC_NUMERIC=C LC_TIME=C.UTF-8 LC_COLLATE=C.UTF-8 [5] LC_MONETARY=C.UTF-8 LC_MESSAGES=C.UTF-8 LC_PAPER=C.UTF-8 LC_NAME=C [9] LC_ADDRESS=C LC_TELEPHONE=C LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C attached base packages: [1] parallel stats4 stats graphics grDevices utils datasets methods base other attached packages: [1] MeSH.Hsa.eg.db_1.15.1 MeSHDbi_1.28.0 GEOquery_2.60.0 dplyr_1.0.10 [5] limma_3.48.2 DT_0.26 biomaRt_2.48.2 org.Hs.eg.db_3.13.0 [9] AnnotationDbi_1.54.1 IRanges_2.26.0 S4Vectors_0.30.0 Biobase_2.52.0 [13] BiocGenerics_0.38.0 DOSE_3.18.3 enrichplot_1.12.3 clusterProfiler_4.0.5 [17] here_1.0.1 loaded via a namespace (and not attached): [1] backports_1.2.1 shadowtext_0.1.1 fastmatch_1.1-3 servr_0.22 [5] BiocFileCache_2.0.0 plyr_1.8.6 igraph_1.2.6 lazyeval_0.2.2 [9] splines_4.1.0 BiocParallel_1.26.1 crosstalk_1.1.1 GenomeInfoDb_1.28.1 [13] ggplot2_3.4.0 meshes_1.18.1 digest_0.6.27 yulab.utils_0.0.4 [17] htmltools_0.5.5 GOSemSim_2.18.1 viridis_0.6.1 GO.db_3.13.0 [21] fansi_0.5.0 checkmate_2.0.0 magrittr_2.0.3 memoise_2.0.1 [25] scriptResume_0.1.4 tzdb_0.1.2 readr_2.0.0 Biostrings_2.60.1 [29] graphlayouts_0.8.0 vroom_1.5.3 prettyunits_1.1.1 colorspace_2.0-2 [33] blob_1.2.2 rappdirs_0.3.3 ggrepel_0.9.1 xfun_0.39 [37] callr_3.7.3 crayon_1.4.1 RCurl_1.98-1.3 jsonlite_1.8.4 [41] graph_1.70.0 scatterpie_0.1.7 ape_5.6-2 glue_1.6.2 [45] polyclip_1.10-0 gtable_0.3.0 zlibbioc_1.38.0 XVector_0.32.0 [49] webshot_0.5.2 graphite_1.38.0 scales_1.2.1 DBI_1.1.1 [53] Rcpp_1.0.7 viridisLite_0.4.0 progress_1.2.2 gridGraphics_0.5-1 [57] tidytree_0.3.9 reactome.db_1.76.0 bit_4.0.4 htmlwidgets_1.5.3 [61] httr_1.4.2 fgsea_1.18.0 RColorBrewer_1.1-2 ellipsis_0.3.2 [65] pkgconfig_2.0.3 XML_3.99-0.6 farver_2.1.0 sass_0.4.0 [69] dbplyr_2.1.1 utf8_1.2.2 later_1.2.0 ggplotify_0.1.0 [73] tidyselect_1.1.1 rlang_1.1.1 reshape2_1.4.4 munsell_0.5.0 [77] tools_4.1.0 cachem_1.0.5 downloader_0.4 cli_3.4.1 [81] generics_0.1.0 RSQLite_2.2.7 evaluate_0.15 stringr_1.5.0 [85] fastmap_1.1.0 yaml_2.2.1 ggtree_3.0.4 processx_3.8.1 [89] knitr_1.39 bit64_4.0.5 tidygraph_1.2.0 purrr_0.3.4 [93] KEGGREST_1.32.0 ggraph_2.0.5 ReactomePA_1.36.0 nlme_3.1-152 [97] mime_0.11 aplot_0.1.2 DO.db_2.9 xml2_1.3.2 [101] compiler_4.1.0 rstudioapi_0.13 filelock_1.0.2 curl_4.3.2 [105] png_0.1-7 treeio_1.16.2 statmod_1.4.36 tibble_3.1.6 [109] tweenr_1.0.2 bslib_0.4.2 stringi_1.7.8 ps_1.6.0 [113] highr_0.9 lattice_0.20-44 Matrix_1.5-3 markdown_1.1 [117] vctrs_0.5.1 pillar_1.6.2 lifecycle_1.0.3 jquerylib_0.1.4 [121] data.table_1.14.0 cowplot_1.1.1 bitops_1.0-7 httpuv_1.6.1 [125] patchwork_1.1.1 qvalue_2.24.0 R6_2.5.1 promises_1.2.0.1 [129] bookdown_0.34 gridExtra_2.3 codetools_0.2-18 MASS_7.3-54 [133] assertthat_0.2.1 rprojroot_2.0.2 withr_2.5.0 GenomeInfoDbData_1.2.6 [137] hms_1.1.0 grid_4.1.0 ggfun_0.0.5 MeSH.db_1.15.1 [141] tidyr_1.2.1 rmarkdown_2.18 ggforce_0.3.3 "],["gene-set-enrichment-analysis.html", "19 Gene set enrichment analysis", " 19 Gene set enrichment analysis "],["data.html", "20 Data", " 20 Data Session Info sessionInfo() R version 4.1.0 (2021-05-18) Platform: x86_64-pc-linux-gnu (64-bit) Running under: Ubuntu 20.04.2 LTS Matrix products: default BLAS: /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0 locale: [1] LC_CTYPE=C.UTF-8 LC_NUMERIC=C LC_TIME=C.UTF-8 LC_COLLATE=C.UTF-8 [5] LC_MONETARY=C.UTF-8 LC_MESSAGES=C.UTF-8 LC_PAPER=C.UTF-8 LC_NAME=C [9] LC_ADDRESS=C LC_TELEPHONE=C LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C attached base packages: [1] parallel stats4 stats graphics grDevices utils datasets methods base other attached packages: [1] MeSH.Hsa.eg.db_1.15.1 MeSHDbi_1.28.0 GEOquery_2.60.0 dplyr_1.0.10 [5] limma_3.48.2 DT_0.26 biomaRt_2.48.2 org.Hs.eg.db_3.13.0 [9] AnnotationDbi_1.54.1 IRanges_2.26.0 S4Vectors_0.30.0 Biobase_2.52.0 [13] BiocGenerics_0.38.0 DOSE_3.18.3 enrichplot_1.12.3 clusterProfiler_4.0.5 [17] here_1.0.1 loaded via a namespace (and not attached): [1] backports_1.2.1 shadowtext_0.1.1 fastmatch_1.1-3 servr_0.22 [5] BiocFileCache_2.0.0 plyr_1.8.6 igraph_1.2.6 lazyeval_0.2.2 [9] splines_4.1.0 BiocParallel_1.26.1 crosstalk_1.1.1 GenomeInfoDb_1.28.1 [13] ggplot2_3.4.0 meshes_1.18.1 digest_0.6.27 yulab.utils_0.0.4 [17] htmltools_0.5.5 GOSemSim_2.18.1 viridis_0.6.1 GO.db_3.13.0 [21] fansi_0.5.0 checkmate_2.0.0 magrittr_2.0.3 memoise_2.0.1 [25] scriptResume_0.1.4 tzdb_0.1.2 readr_2.0.0 Biostrings_2.60.1 [29] graphlayouts_0.8.0 vroom_1.5.3 prettyunits_1.1.1 colorspace_2.0-2 [33] blob_1.2.2 rappdirs_0.3.3 ggrepel_0.9.1 xfun_0.39 [37] callr_3.7.3 crayon_1.4.1 RCurl_1.98-1.3 jsonlite_1.8.4 [41] graph_1.70.0 scatterpie_0.1.7 ape_5.6-2 glue_1.6.2 [45] polyclip_1.10-0 gtable_0.3.0 zlibbioc_1.38.0 XVector_0.32.0 [49] webshot_0.5.2 graphite_1.38.0 scales_1.2.1 DBI_1.1.1 [53] Rcpp_1.0.7 viridisLite_0.4.0 progress_1.2.2 gridGraphics_0.5-1 [57] tidytree_0.3.9 reactome.db_1.76.0 bit_4.0.4 htmlwidgets_1.5.3 [61] httr_1.4.2 fgsea_1.18.0 RColorBrewer_1.1-2 ellipsis_0.3.2 [65] pkgconfig_2.0.3 XML_3.99-0.6 farver_2.1.0 sass_0.4.0 [69] dbplyr_2.1.1 utf8_1.2.2 later_1.2.0 ggplotify_0.1.0 [73] tidyselect_1.1.1 rlang_1.1.1 reshape2_1.4.4 munsell_0.5.0 [77] tools_4.1.0 cachem_1.0.5 downloader_0.4 cli_3.4.1 [81] generics_0.1.0 RSQLite_2.2.7 evaluate_0.15 stringr_1.5.0 [85] fastmap_1.1.0 yaml_2.2.1 ggtree_3.0.4 processx_3.8.1 [89] knitr_1.39 bit64_4.0.5 tidygraph_1.2.0 purrr_0.3.4 [93] KEGGREST_1.32.0 ggraph_2.0.5 ReactomePA_1.36.0 nlme_3.1-152 [97] mime_0.11 aplot_0.1.2 DO.db_2.9 xml2_1.3.2 [101] compiler_4.1.0 rstudioapi_0.13 filelock_1.0.2 curl_4.3.2 [105] png_0.1-7 treeio_1.16.2 statmod_1.4.36 tibble_3.1.6 [109] tweenr_1.0.2 bslib_0.4.2 stringi_1.7.8 ps_1.6.0 [113] highr_0.9 lattice_0.20-44 Matrix_1.5-3 markdown_1.1 [117] vctrs_0.5.1 pillar_1.6.2 lifecycle_1.0.3 jquerylib_0.1.4 [121] data.table_1.14.0 cowplot_1.1.1 bitops_1.0-7 httpuv_1.6.1 [125] patchwork_1.1.1 qvalue_2.24.0 R6_2.5.1 promises_1.2.0.1 [129] bookdown_0.34 gridExtra_2.3 codetools_0.2-18 MASS_7.3-54 [133] assertthat_0.2.1 rprojroot_2.0.2 withr_2.5.0 GenomeInfoDbData_1.2.6 [137] hms_1.1.0 grid_4.1.0 ggfun_0.0.5 MeSH.db_1.15.1 [141] tidyr_1.2.1 rmarkdown_2.18 ggforce_0.3.3 "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
